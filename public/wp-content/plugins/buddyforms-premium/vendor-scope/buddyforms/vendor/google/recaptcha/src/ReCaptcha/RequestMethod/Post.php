<?php
 namespace tk\ReCaptcha\RequestMethod; use tk\ReCaptcha\ReCaptcha; use tk\ReCaptcha\RequestMethod; use tk\ReCaptcha\RequestParameters; class Post implements \tk\ReCaptcha\RequestMethod { private $siteVerifyUrl; public function __construct($siteVerifyUrl = null) { $this->siteVerifyUrl = \is_null($siteVerifyUrl) ? \tk\ReCaptcha\ReCaptcha::SITE_VERIFY_URL : $siteVerifyUrl; } public function submit(\tk\ReCaptcha\RequestParameters $params) { $options = array('http' => array( 'header' => "Content-type: application/x-www-form-urlencoded\r\n", 'method' => 'POST', 'content' => $params->toQueryString(), 'verify_peer' => \true, )); $context = \stream_context_create($options); $response = \file_get_contents($this->siteVerifyUrl, \false, $context); if ($response !== \false) { return $response; } return '{"success": false, "error-codes": ["' . \tk\ReCaptcha\ReCaptcha::E_CONNECTION_FAILED . '"]}'; } } 